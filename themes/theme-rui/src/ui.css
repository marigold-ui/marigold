/*
 * UI Component Utilities
 *
 * This file contains utilities to style UI components consistently,
 * including input and surface styling, state variations, and elevation levels.
 */

/* ========================= */
/*           Input           */
/* ========================= */

/*
 * Provides spacing and text styling for input elements.
 * Visual affordances (borders, backgrounds, shadows) are handled by "ui-surface".
 * Combine both utilities for complete input styling.
 */
@utility ui-input {
  @apply h-button w-full min-w-0;
  @apply px-3 py-2;
  @apply text-foreground placeholder:text-placeholder text-sm;
}

/* ========================= */
/*          Surface          */
/* ========================= */

/* 
 * Use for interactive UI elements like inputs, selects, and cards. Anything that
 * sits on the page background and needs a clear visual boundary. 
 */
@utility ui-surface {
  @apply rounded-surface relative transition-[background,border,box-shadow];

  /* prettier-ignore */
  background:
      linear-gradient(
        to bottom,
        var(--ui-background-color, #fff),
        var(--ui-background-color, #fff)
      ),
      linear-gradient(
        to bottom,
        var(--ui-border-color, var(--color-surface-border)),
        oklch(from var(--ui-border-color, var(--color-surface-border)) calc(l - 0.1) c h)
      );

  background-clip: padding-box, border-box;
  background-origin: padding-box, border-box;
  border: 1px solid transparent;
}

/* 
 * Use when the surface must stand out against the page. Toolbars, action bars,
 * or anything that uses the brand color to signal prominence.
 */
@utility ui-surface-contrast {
  @apply rounded-surface relative transition-[background,border,box-shadow];
  @apply text-brand-foreground;

  @apply inset-shadow-[0_1px_0_0_var(--ui-highlight-color,oklch(from_var(--color-brand)_calc(l+0.4)_c_h))];

  /* prettier-ignore */
  background:
      radial-gradient(ellipse 120% 60% at 50% -25%, var(--ui-highlight-color, oklch(from var(--color-brand) calc(l + 0.4) c h)), transparent 90%),
      linear-gradient(
        to bottom,
        var(--ui-background-color, var(--color-brand)),
        var(--ui-background-color, var(--color-brand))
      ),
      linear-gradient(
        to bottom,
        oklch(from var(--ui-border-color, var(--color-brand)) calc(l + 0.2) c h),
        oklch(from var(--ui-border-color, var(--color-brand)) calc(l + 0.15) c h)
      );

  background-clip: padding-box, padding-box, border-box;
  background-origin: padding-box, padding-box, border-box;
  border: 1px solid transparent;
}

/* ========================= */
/*           State           */
/* ========================= */

/*
 * Applies a consistent visual style used for keyboard focus states across components.
 * Used this when the border of the component can be changed.
 */
@utility ui-state-focus {
  @apply ring-ring/50 ring-[3px] outline-none;
  --ui-border-color: var(--color-ring);
}

/*
* Applies a consistent visual style for invalid elements.
*/
@utility ui-state-error {
  /* Overrides the transparent border. Gradient would get too dark. */
  @apply border-destructive shadow-destructive/20;
  @apply focus:border-destructive focus:ring-destructive/20;
}

/*
 * Applies a consistent visual style for disabled elements.
 */
@utility ui-state-disabled {
  @apply text-disabled-foreground cursor-not-allowed;
  background: var(--color-disabled);
  background-clip: border-box;
  box-shadow: none;
}

/*
 * Applies a consistent visual style for readonly elements.
 */
@utility ui-state-readonly {
  --ui-background-color: var(--color-muted);
}

/*
 * Applies focus ring, disabled state, and pointer cursor to any interactive element.
 * Combines: focus-visible:ui-state-focus, outline-none, disabled:ui-state-disabled, cursor-pointer
 */
@utility ui-interactive {
  @apply cursor-pointer outline-none;
  @apply focus-visible:ui-state-focus;
  @apply disabled:ui-state-disabled;
}

/*
 * Base styles shared by all button-like elements (Button, ToggleButton, Menu.button,
 * Pagination buttons, IconButton).
 */
@utility ui-button-base {
  @apply inline-flex items-center justify-center;
  @apply rounded-surface font-medium whitespace-nowrap transition-[color,box-shadow,transform];
  @apply ui-interactive;
  @apply border border-transparent;

  & svg {
    pointer-events: none;
    flex-shrink: 0;
  }
}

/*
 * Applies press/tap scale feedback (150ms, 97% scale on :active and [data-pressed]).
 * Used by button-like elements that are not regular Buttons (which have a different
 * pressed:not-aria-expanded variant).
 */
@utility ui-press {
  transition-duration: 150ms;
  &:active {
    scale: 0.97;
  }
  &[data-pressed] {
    scale: 0.97;
  }
}

/*
 * Standard panel header slot — shared by Drawer and Tray.
 */
@utility ui-panel-header {
  @apply border-border border-b px-6 py-4;
}

/*
 * Standard panel actions slot — shared by Drawer and Tray.
 */
@utility ui-panel-actions {
  @apply border-border flex flex-row justify-end gap-3 border-t px-6 py-4;
}

/* ========================= */
/*       Touch & Scroll      */
/* ========================= */

/*
 * Applies a touch-friendly hitbox to elements, ensuring they are easily tappable on touch devices.
 * This is important for accessibility, as it helps meet WCAG guidelines for minimum touch target size
 * and improves usability for users with motor impairments.
 */
@utility ui-touch-hitbox {
  position: relative;
  &:before {
    content: '';
    position: absolute;
    display: block;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    /* Touch target minimum 24x24px (WCAG 2.1 AA) */
    /* For WCAG 2.2 compliance, update to 44x44px */
    /* Uses z-100 to ensure hitbox is above content but below system overlays */
    min-height: 24px;
    min-width: 24px;
    z-index: 100;
  }
}

/*
 * Custom scrollbar styling to match the theme's design.
 * This utility provides a consistent look for scrollbars across different browsers.
 */
@utility ui-scrollbar {
  scrollbar-width: auto;
  scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);

  &::-webkit-scrollbar {
    display: block;
    width: 12px;
    height: 12px;
  }

  &::-webkit-scrollbar-track {
    background-color: var(--color-scrollbar-track);
    border-radius: var(--radius-full);
  }

  &::-webkit-scrollbar-thumb {
    transition: background-color 0.2s var(--ease-out-quad);
    background-color: var(--color-scrollbar);
    border-radius: var(--radius-full);
    border: 0px solid transparent;
  }
  &::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-scrollbar-hover);
  }
}
