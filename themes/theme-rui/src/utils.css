/*
 * Custom Tailwind utilities
 *
 * This file contains reusable utility functions and class shortcuts that
 * encapsulate common design decisions across the theme. These include
 * standardized styling for interactive states like keyboard focus, disabled
 * components, and other consistent UI patterns.
 */

/* ========================= */
/*    Surface & Elevation    */
/* ========================= */

/*
 * The "surface" utitlities define visual surfaces with distinct background colors. Apply 
 * elevation levels to them when needed.
 * 
 * Uses gradient borders and layered shadows for single-element styling.
 * Works on both container and input elements without requiring ::before pseudo-element.
 */
@utility surface {
  @apply relative;
  @apply rounded-surface;
  @apply transition-[box-shadow,border];
  
  /* Gradient border using background layers */
  background: 
    linear-gradient(var(--color-surface), var(--color-surface)) padding-box,
    linear-gradient(
      to bottom,
      var(--color-surface-border),
      oklch(from var(--color-surface-border) calc(l - 0.15) c h)
    ) border-box;
  border: 1px solid transparent;
  
  /* Layered shadows for depth (Josh Comeau approach) */
  box-shadow:
    0 1px 1px hsl(0deg 0% 0% / 0.075),
    0 2px 2px hsl(0deg 0% 0% / 0.075),
    0 4px 4px hsl(0deg 0% 0% / 0.075),
    0 8px 8px hsl(0deg 0% 0% / 0.075);
}

/*
 * @deprecated Use .surface directly instead. This class is no longer needed
 * as the .surface class now works on input elements directly.
 * 
 * Note: The padding and text styling should now be applied separately in component styles.
 */
@utility surface-input {
  @apply w-full min-w-0;
  @apply px-[calc(--spacing(3)-1px)] py-[calc(--spacing(2)-1px)];
  @apply text-foreground placeholder:text-placeholder text-sm;
  @apply outline-none;
}

/*
 * The "elevation" utilities define elevation levels.
 * Elevation is conveyed through shadows and borders, helping establish 
 * depth, hierarchy, and separation between interface layers. Use them to apply 
 * consistent surface styling across components.
 */

/*
 * Use this utility when you want to visually lift an element above the base level,
 * such as for cards, or interactive components that require emphasis. This is the 
 * lowest elevation level.
 * 
 * Uses lighter layered shadows than the base surface.
 */
@utility elevation-raised {
  box-shadow:
    0 1px 2px hsl(0deg 0% 0% / 0.06),
    0 2px 4px hsl(0deg 0% 0% / 0.06),
    0 4px 8px hsl(0deg 0% 0% / 0.06),
    0 8px 16px hsl(0deg 0% 0% / 0.06);
}

/*
 * Use this utility when you want to visually lift an element above the raised level,
 * such as for dialogs, or popups. This is the highest elevation level.
 * 
 * Uses heavier layered shadows for maximum depth.
 */
@utility elevation-overlay {
  box-shadow:
    0 2px 4px hsl(0deg 0% 0% / 0.1),
    0 4px 8px hsl(0deg 0% 0% / 0.1),
    0 8px 16px hsl(0deg 0% 0% / 0.1),
    0 16px 32px hsl(0deg 0% 0% / 0.1);
}

/* ========================= */
/*           State           */
/* ========================= */

/*
 * Applies a consistent visual style for invalid elements.
 * Works with gradient border approach by changing border color.
 */
@utility surface-error {
  background: 
    linear-gradient(var(--color-surface), var(--color-surface)) padding-box,
    linear-gradient(
      to bottom,
      var(--color-destructive),
      oklch(from var(--color-destructive) calc(l - 0.15) c h)
    ) border-box;
  border: 1px solid transparent;
}

/*
 * Applies a consistent visual style when an element has an invalid child element.
 * Works with gradient border approach by changing border color.
 */
@utility surface-has-error {
  background: 
    linear-gradient(var(--color-surface), var(--color-surface)) padding-box,
    linear-gradient(
      to bottom,
      var(--color-destructive),
      oklch(from var(--color-destructive) calc(l - 0.15) c h)
    ) border-box;
  border: 1px solid transparent;
}

/*
 * Applies a consistent visual style for disabled elements.
 */
@utility state-disabled {
  @apply text-disabled-foreground bg-disabled cursor-not-allowed;
}

/*
 * Applies a consistent visual style for readonly elements.
 */
@utility state-readonly {
  @apply bg-muted;
}

/*
 * Applies a consistent visual style used for keyboard focus states across components.
 * Used this when the border of the component can be changed.
 * Enhanced with layered shadow for depth.
 */
@utility state-focus {
  background: 
    linear-gradient(var(--color-surface), var(--color-surface)) padding-box,
    linear-gradient(
      to bottom,
      var(--color-ring),
      oklch(from var(--color-ring) calc(l - 0.15) c h)
    ) border-box;
  border: 1px solid transparent;
  @apply ring-ring/50 ring-[3px];
}

/*
 * Applies a consistent visual style used for keyboard focus states across components.
 * Used this when the border of the component should not be changed.
 */
@utility state-focus-borderless {
  @apply ring-ring/50 ring-[3px];
}

/* ========================= */
/*            Misc           */
/* ========================= */

/*
 * Applies a touch-friendly hitbox to elements, ensuring they are easily tappable on touch devices. 
 * This is important for accessibility, as it helps meet WCAG guidelines for minimum touch target size 
 * and improves usability for users with motor impairments.
 */
@utility util-touch-hitbox {
  position: relative;
  &:before {
    content: '';
    position: absolute;
    display: block;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    /* 24x24px is WCAG before 2.2, to support 2.2 this needs to be 44x44px */
    min-height: 24px;
    min-width: 24px;
    z-index: 9999;
  }
}

/*
 * Custom scrollbar styling to match the theme's design.
 * This utility provides a consistent look for scrollbars across different browsers.
 */
@utility util-scrollbar {
  scrollbar-width: auto;
  scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);

  &::-webkit-scrollbar {
    display: block;
    width: 12px;
    height: 12px;
  }

  &::-webkit-scrollbar-track {
    background-color: var(--color-scrollbar-track);
    border-radius: var(--radius-full);
  }

  &::-webkit-scrollbar-thumb {
    transition: background-color 0.2s var(--ease-out-quad);
    background-color: var(--color-scrollbar);
    border-radius: var(--radius-full);
    border: 0px solid transparent;
  }
  &::-webkit-scrollbar-thumb:hover {
    background-color: var(--color-scrollbar-hover);
  }
}

/* ==========================================================  */

/* ========================= */
/*    Surface & Elevation    */
/* ========================= */

/* Go over these when doing DST-878 */

@utility util-surface-sunken {
  background: var(--surface-sunken);

  --tw-shadow: var(--surface-sunken-shadow);
  box-shadow:
    var(--tw-inset-shadow), var(--tw-inset-ring-shadow),
    var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
}

@utility util-surface-body {
  background: var(--surface-body);

  --tw-shadow: var(--surface-body-shadow);
  box-shadow:
    var(--tw-inset-shadow), var(--tw-inset-ring-shadow),
    var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
}

@utility util-surface-raised {
  background: var(--surface-raised);
  border: 1px var(--tw-border-style) var(--surface-raised-border);

  --tw-shadow: var(--surface-raised-shadow);
  box-shadow:
    var(--tw-inset-shadow), var(--tw-inset-ring-shadow),
    var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
}

@utility util-surface-overlay {
  background: var(--surface-overlay);
  border: 1px var(--tw-border-style) var(--surface-overlay-border);

  --tw-shadow: var(--surface-overlay-shadow);
  box-shadow:
    var(--tw-inset-shadow), var(--tw-inset-ring-shadow),
    var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
}
